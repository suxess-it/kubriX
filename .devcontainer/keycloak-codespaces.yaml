apiVersion: openidclient.keycloak.crossplane.io/v1alpha1
kind: Client
metadata:
  name: backstage-codespaces
spec:
  deletionPolicy: Delete
  forProvider:
    accessType: CONFIDENTIAL 
    clientId: backstage-codespaces
    name: backstage-codespaces
    realmId: sx-cnp-oss-codespaces
    directAccessGrantsEnabled: false
    standardFlowEnabled: true
    serviceAccountsEnabled: true
  #    managementPolicies: ["Observe"]
    validRedirectUris:
      - "http://localhost:7007/api/auth/oidc/handler/frame"
      - "https://BACKSTAGE_CODESPACES_REPLACE/api/auth/oidc/handler/frame"
    clientSecretSecretRef:
      key: backstage-codespaces
      name: "sx-keycloak-client-backstage-codespaces-password"
      namespace: keycloak
    loginTheme: keycloak
  providerConfigRef:
    name: "sx-keycloak-config"
---
apiVersion: realm.keycloak.crossplane.io/v1alpha1
kind: Realm
metadata:
  name: sx-cnp-oss-codespaces
  labels:
    platform-engineer.cloud/realm: sx-cnp-oss-codespaces
spec:
  forProvider:
    realm: sx-cnp-oss-codespaces
    displayName: sx-cnp-oss-codespaces
    attributes:
      frontendUrl: https://KEYCLOAK_CODESPACES_REPLACE
  deletionPolicy: "Delete"
  providerConfigRef:
    name: "sx-keycloak-config"